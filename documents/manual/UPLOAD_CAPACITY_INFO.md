# ğŸ“¤ íŒŒì¼ ì—…ë¡œë“œ ìš©ëŸ‰ ë° í•œê¸€ íŒŒì¼ëª… ì²˜ë¦¬ ì•ˆë‚´

## ğŸ” í˜„ì¬ í™•ì¸ëœ ì •ë³´ ìš”ì•½

### 1ï¸âƒ£ **íŒŒì¼ ì—…ë¡œë“œ ìš©ëŸ‰ ì œí•œ**

#### âœ… ë°±ì—”ë“œ ì„œë²„ ì„¤ì • (FastAPI/Uvicorn)
- **ìµœëŒ€ ì—…ë¡œë“œ í¬ê¸°: 100MB**
- ì½”ë“œ ìœ„ì¹˜: `backend/main.py` ë¼ì¸ 4183
- ì œí•œ ì´ˆê³¼ ì‹œ: `413 (Payload Too Large)` ì—ëŸ¬ ë°œìƒ
- ì—ëŸ¬ ë©”ì‹œì§€: "íŒŒì¼ í¬ê¸°ëŠ” 100MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"

```python
# backend/main.py (line 4178-4184)
if file_size > 100 * 1024 * 1024:
    raise HTTPException(
        status_code=413, 
        detail=f"íŒŒì¼ í¬ê¸°ëŠ” 100MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (í˜„ì¬: {file_size / 1024 / 1024:.2f}MB)"
    )
```

#### âœ… í—ˆìš©ë˜ëŠ” íŒŒì¼ í˜•ì‹
```python
allowed_extensions = [
    # ì´ë¯¸ì§€
    '.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp',
    
    # ë¬¸ì„œ
    '.pdf',          # PDF
    '.ppt', '.pptx', # PowerPoint
    '.xls', '.xlsx', # Excel
    '.doc', '.docx', # Word
    '.txt',          # í…ìŠ¤íŠ¸
    '.hwp'           # í•œê¸€
]
```

#### âœ… í”„ë¡ íŠ¸ì—”ë“œ ìë™ ì••ì¶• ê¸°ëŠ¥
- **20MB ì´ìƒ ì´ë¯¸ì§€**: ìë™ ì••ì¶• ì‹¤í–‰ (83%+ ìš©ëŸ‰ ê°ì†Œ)
- **ì°¨ë“± ì••ì¶•**:
  - 20MB ì´ìƒ: 1280px í¬ê¸°ë¡œ ì¶•ì†Œ, 60% í’ˆì§ˆ
  - 10-20MB: 1600px í¬ê¸°ë¡œ ì¶•ì†Œ, 70% í’ˆì§ˆ
- Canvas APIë¥¼ ì‚¬ìš©í•œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì••ì¶•

---

### 2ï¸âƒ£ **í•œê¸€ íŒŒì¼ëª… ì²˜ë¦¬ ë°©ì‹**

#### âœ… ë°±ì—”ë“œ íŒŒì¼ëª… ì•ˆì „í™” ì²˜ë¦¬
**ì›ë³¸ íŒŒì¼ëª…ì€ ë³´ì¡´ë˜ì§€ë§Œ, ì‹¤ì œ ì €ì¥ ì‹œ ASCII ë¬¸ìë¡œ ë³€í™˜ë©ë‹ˆë‹¤.**

```python
# backend/main.py (line 4193-4215)
# 1. íƒ€ì„ìŠ¤íƒ¬í”„ + UUIDë¡œ ê³ ìœ  ID ìƒì„±
timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
unique_id = str(uuid.uuid4())[:8]

# 2. í•œê¸€/íŠ¹ìˆ˜ë¬¸ìë¥¼ ì–¸ë”ìŠ¤ì½”ì–´(_)ë¡œ ë³€í™˜
safe_name = ""
for c in original_name:
    if c.isascii() and (c.isalnum() or c in ('-', '_', '.')):
        safe_name += c
    else:
        safe_name += '_'  # í•œê¸€ â†’ _

# 3. ìµœì¢… íŒŒì¼ëª… ìƒì„±
new_filename = f"{timestamp}_{unique_id}_{safe_name}{file_ext}"
```

#### ğŸ“ ì˜ˆì‹œ
| ì›ë³¸ íŒŒì¼ëª… | ì €ì¥ë˜ëŠ” íŒŒì¼ëª… |
|------------|---------------|
| `í•™ìƒìë£Œ.pdf` | `20251219_a1b2c3d4_____. pdf` |
| `ìƒë‹´ì¼ì§€-ê¹€ì² ìˆ˜.docx` | `20251219_e5f6g7h8___________.docx` |
| `Profile_Photo.jpg` | `20251219_i9j0k1l2_Profile_Photo.jpg` |
| `í”„ë¡œì íŠ¸ ìµœì¢… ë³´ê³ ì„œ.hwp` | `20251219_m3n4o5p6_____________.hwp` |

#### âœ… FTP ì„œë²„ í•œê¸€ ì§€ì›
- **FTP ì¸ì½”ë”©: UTF-8**
- ëª¨ë“  FTP ì—°ê²°ì— `ftp.encoding = 'utf-8'` ì„¤ì •ë¨
- FTP ì„œë²„ì—ì„œ í•œê¸€ ë””ë ‰í† ë¦¬ ë° íŒŒì¼ ê²½ë¡œ ì²˜ë¦¬ ê°€ëŠ¥

```python
# ëª¨ë“  FTP ì—°ê²°ì—ì„œ UTF-8 ì¸ì½”ë”© ì‚¬ìš©
ftp = FTP()
ftp.encoding = 'utf-8'  # í•œê¸€ íŒŒì¼ëª… ì§€ì›
ftp.connect(host, port)
ftp.login(user, passwd)
```

---

### 3ï¸âƒ£ **ì›ë³¸ íŒŒì¼ëª… ë³´ì¡´**

#### âœ… ë°ì´í„°ë² ì´ìŠ¤ ë° API ì‘ë‹µ
- ì›ë³¸ íŒŒì¼ëª…ì€ `original_filename` í•„ë“œë¡œ ë³´ì¡´
- API ì‘ë‹µì— í¬í•¨ë¨

```json
{
  "success": true,
  "url": "ftp://server/path/20251219_a1b2c3d4_____. pdf",
  "filename": "20251219_a1b2c3d4_____. pdf",
  "original_filename": "í•™ìƒìë£Œ.pdf",  // âœ… ì›ë³¸ íŒŒì¼ëª… ë³´ì¡´
  "size": 2048576
}
```

#### âœ… í”„ë¡ íŠ¸ì—”ë“œ í‘œì‹œ
- íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹œ ì›ë³¸ íŒŒì¼ëª…ìœ¼ë¡œ ì €ì¥
- ì‚¬ìš©ìì—ê²ŒëŠ” ì›ë³¸ íŒŒì¼ëª…ì´ í‘œì‹œë¨

---

## ğŸ”§ ì•Œë ¤ì§„ ë¬¸ì œ ë° í•´ê²° ìƒíƒœ

### âœ… í•´ê²°ë¨
1. **Windows ì„ì‹œ ë””ë ‰í† ë¦¬ ì˜¤ë¥˜** â†’ `tempfile.gettempdir()` ì‚¬ìš©
2. **FTP í•œê¸€ ì¸ì½”ë”© ì˜¤ë¥˜** â†’ ëª¨ë“  FTP ì—°ê²°ì— UTF-8 ì„¤ì •
3. **ì¸ë„¤ì¼ ê²½ë¡œ ì˜¤ë¥˜** â†’ í¬ë¡œìŠ¤ í”Œë«í¼ ê²½ë¡œ ì‚¬ìš©

### âš ï¸ ì£¼ì˜ì‚¬í•­
1. **í•œê¸€ íŒŒì¼ëª… â†’ ASCII ë³€í™˜**
   - íŒŒì¼ëª…ì˜ í•œê¸€ì€ ì–¸ë”ìŠ¤ì½”ì–´ë¡œ ë³€ê²½ë¨
   - ì›ë³¸ íŒŒì¼ëª…ì€ ë©”íƒ€ë°ì´í„°ë¡œ ë³´ì¡´
   
2. **íŒŒì¼ í¬ê¸° ì œí•œ**
   - ë°±ì—”ë“œ: 100MB í•˜ë“œ ë¦¬ë¯¸íŠ¸
   - í”„ë¡ íŠ¸ì—”ë“œ: 20MB+ ì´ë¯¸ì§€ ìë™ ì••ì¶•
   
3. **FTP ì„œë²„ ì—°ê²°**
   - `bitnmeta2.synology.me:2121` ì ‘ê·¼ í•„ìš”
   - ë°©í™”ë²½/VPN ì„¤ì • í™•ì¸ í•„ìš”

---

## ğŸ“Š ì—…ë¡œë“œ í”„ë¡œì„¸ìŠ¤ ìš”ì•½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‚¬ìš©ìê°€ íŒŒì¼ ì„ íƒ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íŒŒì¼ í¬ê¸° ì²´í¬     â”‚  â†’ 100MB ì´ˆê³¼ ì‹œ 413 ì—ëŸ¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íŒŒì¼ëª… ì•ˆì „í™”      â”‚  â†’ í•œê¸€ â†’ ì–¸ë”ìŠ¤ì½”ì–´(_)
â”‚ íƒ€ì„ìŠ¤íƒ¬í”„+UUID ì¶”ê°€â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FTP ì—…ë¡œë“œ        â”‚  â†’ UTF-8 ì¸ì½”ë”©ìœ¼ë¡œ ì „ì†¡
â”‚ (ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¸ë„¤ì¼ ìƒì„±(ì´ë¯¸ì§€)â”‚  â†’ 200x200px JPEG
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì—…ë¡œë“œ ì™„ë£Œ        â”‚  â†’ FTP URL + ì›ë³¸ íŒŒì¼ëª… ë°˜í™˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ê°œì„  ì œì•ˆ (Optional)

### 1. ë” í° íŒŒì¼ ì§€ì›
```python
# í˜„ì¬: 100MB ì œí•œ
if file_size > 100 * 1024 * 1024:

# ì œì•ˆ: 500MBê¹Œì§€ í™•ì¥
if file_size > 500 * 1024 * 1024:
```

### 2. í•œê¸€ íŒŒì¼ëª… ë³´ì¡´ (Optional)
- FTP ì„œë²„ê°€ UTF-8ì„ ì™„ì „íˆ ì§€ì›í•œë‹¤ë©´ í•œê¸€ íŒŒì¼ëª… ê·¸ëŒ€ë¡œ ì €ì¥ ê°€ëŠ¥
- í˜„ì¬ëŠ” ì•ˆì •ì„±ì„ ìœ„í•´ ASCIIë¡œ ë³€í™˜

### 3. ì§„í–‰ë¥  í‘œì‹œ
- ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ ì‹œ ì§„í–‰ë¥  UI ì¶”ê°€
- WebSocket ë˜ëŠ” Server-Sent Events í™œìš©

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1ï¸âƒ£ ì—…ë¡œë“œ ìš©ëŸ‰ í…ŒìŠ¤íŠ¸
```bash
# 100MB ë¯¸ë§Œ íŒŒì¼
curl -X POST "http://localhost:8000/api/upload-image?category=student" \
     -F "file=@small_file.pdf"

# 100MB ì´ˆê³¼ íŒŒì¼ (413 ì—ëŸ¬ ì˜ˆìƒ)
curl -X POST "http://localhost:8000/api/upload-image?category=student" \
     -F "file=@large_file.pdf"
```

### 2ï¸âƒ£ í•œê¸€ íŒŒì¼ëª… í…ŒìŠ¤íŠ¸
```bash
# í•œê¸€ íŒŒì¼ëª… ì—…ë¡œë“œ
curl -X POST "http://localhost:8000/api/upload-image?category=student" \
     -F "file=@í•™ìƒìë£Œ.pdf"

# ì‘ë‹µ í™•ì¸ (original_filename í•„ë“œ)
{
  "original_filename": "í•™ìƒìë£Œ.pdf",  // âœ… ì›ë³¸ ë³´ì¡´
  "filename": "20251219_xxxxx_____. pdf"  // ë³€í™˜ëœ íŒŒì¼ëª…
}
```

---

## ğŸ”— ê´€ë ¨ íŒŒì¼

- `backend/main.py` (ë¼ì¸ 4144-4231): íŒŒì¼ ì—…ë¡œë“œ API
- `backend/main.py` (ë¼ì¸ 213-280): FTP ì—…ë¡œë“œ í•¨ìˆ˜
- `frontend/app.js`: íŒŒì¼ ì—…ë¡œë“œ UI ë° ì••ì¶•
- `README.md`: í”„ë¡œì íŠ¸ ì „ë°˜ ì„¤ëª…

---

## ğŸ“ ë¬¸ì˜ ë° ì§€ì›

- GitHub: https://github.com/EmmettHwang/BH2025_WOWU
- API ë¬¸ì„œ: http://localhost:8000/docs
