# 교육관리 플랫폼
**통합 교육 관리 시스템 + RAG 기반 지식 검색 + AI 문제 생성**

## 🎓 프로젝트 개요
FastAPI 백엔드 + Vanilla JavaScript 프론트엔드 + RAG 시스템으로 구성된 통합 솔루션입니다.

- **완성일**: 2026년 02월 06일
- **버전**: v5.6.9.202602061800
- **상태**: ✅ 프로덕션 배포 완료
- **코드량**: 40,663줄 (백엔드 13,498 + 프론트엔드 54,626)

## 🎯 최신 업데이트 (v5.6.9)

### ✅ 대시보드 패널 숨기기 기능 + BGM 버그 수정 (2026-02-06)

#### 대시보드 패널 표시 설정
- **톱니바퀴 설정 버튼**: 대시보드 헤더 우측에 패널 표시/숨기기 설정 버튼 추가
- **6개 패널 개별 토글**: 통계 카드, 차트, 진도율, 시간표/상담, 훈련일지/팀활동, 서비스 모니터
- **localStorage 저장**: `dashboard_hidden_panels` 키로 설정 영구 저장, 새로고침 후에도 유지
- **서비스 모니터 최적화**: 패널 숨기면 5초 갱신 interval 자동 정리

#### 서비스 모니터 & 시스템 모니터 컴팩트화
- **서비스 모니터**: 패딩 축소, 서비스 목록 max-height 120px + 스크롤
- **시스템 모니터**: 게이지 SVG w10→w8, 접속 카운터/하단 요약바 폰트 축소
- **전체 높이 절감**: 마진/갭/라운드 축소로 대시보드 하단 영역 컴팩트화

#### BGM YouTube API 키 버그 수정
- **기존 문제**: 설정 탭 미방문 시 localStorage에 API 키 없어 "API 키를 먼저 입력" 에러
- **수정**: `searchYouTubeBGM()`에서 키 없으면 `/api/system-settings`에서 서버 키 자동 로드

### ✅ 이전 업데이트 (v5.6.8, 2026-02-06)

#### 대시보드 서비스 모니터 & 시스템 모니터 패널 추가

### ✅ 이전 업데이트 (v5.6.7, 2026-02-07)

#### 시스템 점검 시각화 대폭 강화
- CSS 애니메이션 12개 키프레임, 다크 그라데이션 헤더, SVG 프로그레스 링
- 카테고리별 시각화 패널 7종, AI 실제 API 호출 테스트, 결과 대시보드

### ✅ 이전 업데이트 (v5.6.6, 2026-02-06)

#### 서버 시작 시간 최적화 (RAG 백그라운드 로딩)
- **시작 시간 단축**: 서버 시작 약 2분 30초 → 약 22초로 대폭 단축
- **백그라운드 스레드**: RAG 임베딩 모델(`ko-sroberta-multitask`) 로드를 백그라운드 스레드로 전환

#### 시스템점검 디버그 로그 / 캐시 버스팅

### ✅ 이전 업데이트 (v5.6.5, 2026-02-06)

#### 상담 추이 과정별 멀티라인 차트
- **전체 과정 선택 시**: 각 과정별 다른 색상의 개별 라인으로 7일 상담 추이 표시
- **범례 표시**: 차트 하단에 과정명 범례 자동 생성
- **특정 과정 선택 시**: 기존 단일 라인 차트 유지

#### 대시보드 차트 슬롯 최적화
- **전체 과정**: 과정별 학생 현황 차트 표시
- **특정 과정 선택**: 진로 결정 현황 차트로 자동 전환

#### 강사관리 기능 개선
- **강사 삭제 500 에러 수정**: FK 제약조건 참조 테이블 NULL 처리 후 삭제
- **목록 UI 변경**: 전공·소속·역할 표시, 강사타입·이메일 숨김
- **빈 전공 기본값**: 전공 미입력 시 "바이오헬스관련" 표시
- **소속 조회 수정**: GET API SELECT 쿼리에 motto, affiliation 컬럼 추가
- **아바타 이미지**: 프로필 사진 없는 강사에 Dicebear 아바타 자동 생성

#### 관리 페이지 헤더 정렬 기능 추가
- **정렬 지원**: 과정관리, 학생관리, 상담관리, SSIRN메모장, 팀관리, 팀활동일지
- **정렬 아이콘**: 헤더 클릭 시 오름차순/내림차순 토글, 현재 정렬 상태 아이콘 표시
- **공통 함수**: sortableHeader(), genericSort() 헬퍼 함수로 통일

#### 시간표·훈련일지 누적시간 수정
- **프로젝트/현장실습 분리**: subject_code가 NULL인 항목을 type별로 구분하여 누적
- **3개 렌더링 경로 모두 수정**: 초기 렌더, renderTimetableList(), renderTrainingLogsTable()

### ✅ 이전 업데이트 (v5.6.4, 2026-02-06)

#### 프로젝트 설정 업데이트
- **CLAUDE.md 업데이트**: 프로젝트명 KDT2025로 변경
- **시작 인사 변경**: "KDT2025에 오신 것을 환영합니다!"
- **버전 보고 추가**: 접속 시 현재 버전 자동 보고

### ✅ 이전 업데이트 (v5.6.3, 2026-02-06)

#### 신규가입 승인 UI 개선
- **과정 선택 모달**: 승인 시 과정을 확인/변경할 수 있는 예쁜 모달 추가
- **신청자 정보 표시**: 프로필, 이름, 연락처, 생년월일, 신청 과정 한눈에 확인
- **드롭다운 과정 선택**: 신청한 과정이 기본 선택되며, 다른 과정으로 변경 가능
- **학생 목록 자동 리프레시**: 승인 후 학생 목록도 자동 갱신

#### 확인 모달 시스템 추가
- **showConfirmModal**: 범용 확인 모달 함수 추가
- **거절 모달**: 거절 시에도 예쁜 모달 표시
- **invalidateCache 에러 수정**: 존재하지 않는 함수 호출 제거

#### UI 텍스트 변경
- **신규수강신청 → 교육신청서**: 로그인 페이지, 모바일 로그인, 신청서 페이지 전체 반영

### ✅ 이전 업데이트 (v5.6.2, 2026-02-04)

#### 학생 Excel 업로드 필드 매핑 기능 추가
- **미리보기 API**: Excel 파일 업로드 시 컬럼 자동 분석 및 매핑 제안
- **필드 매핑 UI**: 시스템 필드와 Excel 컬럼 수동 매핑 지원
- **자동 매칭**: 키워드 기반 자동 컬럼 매칭 (이름, 전화, 이메일 등)
- **과정 선택**: 업로드 시 과정 코드 지정 가능
- **샘플 데이터**: 미리보기에서 첫 3행 샘플 표시

### ✅ 이전 업데이트 (v5.6.1, 2026-02-03)

#### 전체 관리 페이지 Excel 내보내기/업로드 기능 추가
- **학생관리**: Excel 내보내기 (전체/과정별)
- **강사관리**: 템플릿 다운로드, Excel 업로드, Excel 내보내기
- **상담관리**: Excel 내보내기 (전체/과정별), Excel 업로드
- **시간표관리**: Excel 내보내기 (전체/과정별), Excel 업로드
- **훈련일지관리**: Excel 내보내기 (전체/과정별)
- **팀관리**: Excel 내보내기 (전체/과정별), Excel 업로드
- **팀활동일지관리**: Excel 내보내기 (전체/팀별), Excel 업로드
- **범용 모달**: showModal/closeModal 함수로 선택 UI 제공
- **SheetJS 라이브러리**: 클라이언트 사이드 Excel 생성/파싱 지원

#### 모바일 API 캐시 방지 추가
- **캐시 방지 헤더**: 모든 모바일 페이지에 Cache-Control, Pragma, Expires 헤더 추가
- **서비스 워커 업데이트**: 캐시 버전 v3 → v4 업그레이드

#### 학생 목록 과정별 구분 및 넘버링
- **과정별 그룹화**: 전체 과정 선택 시 과정별로 테이블 분리 표시
- **No 열 추가**: 각 과정 내에서 학생 번호 1번부터 넘버링
- **과정 헤더 표시**: 과정명과 학생 수 표시 (예: "과정명 (25명)")

### ✅ 이전 업데이트 (v5.4.0)

#### 교육지원제도 페이지 전면 개편
- **KDT 훈련장려금**: 월 최저 60만원으로 업데이트
- **바이오헬스 인재양성**: 교육비 본인 부담 40만원, 현장실습비 지원 항목 추가
- **국민취업지원제도 신설**: 기존 훈련장려금 안내를 국민취업지원제도로 변경
  - Ⅰ유형: 구직촉진수당 월 50만원×6개월 (최대 300만원)
  - Ⅱ유형: 취업활동비용 월 28.4만원, 직업훈련비 215만원
  - 청년특례, 취업성공수당 상세 안내
- **대전 국민취업지원센터**: 042-226-9114 연락처 추가

#### UI 텍스트 개선
- **신규가입 → 신규수강신청**: 전체 페이지에서 용어 통일
  - login.html, register.html, course-intro.html, education-support.html, mobile/login.html

### ✅ 이전 업데이트 (v5.3.1)

#### 로그인 페이지 버튼 설정 (신규)
- **시스템 설정에서 제어**: 로그인 페이지 버튼들의 표시/숨김을 시스템 설정에서 관리
- **제어 가능 버튼**: 신규가입, 과정소개, 교육지원제도, 페이스북, 인스타그램
- **실시간 반영**: 설정 저장 후 로그인 페이지에서 즉시 반영

#### 로그인 페이지 개선
- **과정 소개 페이지 신설**: `/course-intro.html` - 과정 상세 정보 전용 페이지
  - 과정 기본정보, 정원, 총 교육일수/시간, 교육장소
  - 교육 일정 타임라인 (시작~종료)
  - 강의/프로젝트/현장실습 시간 구성 (막대그래프)
  - 특이사항, 교과목 목록
  - 신규 수강 신청 바로가기
- **교육지원제도 페이지 신설**: `/education-support.html`
  - 국민내일배움카드, K-Digital Training, 바이오헬스 인재양성
  - 훈련장려금 안내, 신청 절차
- **로그인 페이지 UI 개선**: "문제가 있으신가요?" 제거, 과정소개/교육지원제도 버튼 추가

#### RAG 문서 처리 개선
- **닫기 버튼 추가**: 문서 처리 모달에 X 버튼 추가
- **백그라운드 처리**: 모달 닫아도 백그라운드에서 계속 처리

#### 서버 로그 시스템 추가
- **로그 로테이션**: 7일 단위 자동 로테이션
- **로그 위치**: `backend/logs/app.log`
- **포맷**: 날짜-레벨-메시지

### ✅ 이전 업데이트 (v5.2)

#### BGM 설정 버그 수정
- **YouTube API 키 자동 로드**: 시스템 설정 페이지 방문 없이도 서버에 저장된 API 키가 자동으로 로드되어 BGM 즉시 재생 가능
- **localStorage 동기화 개선**: YouTube API 키, BGM 장르, BGM 볼륨을 UI 요소 유무와 상관없이 localStorage에 저장

#### RAG 문서 업로드 개선
- **비동기 처리**: 대용량 문서 업로드 시 백그라운드 태스크로 처리
- **실시간 상태 폴링**: 파싱 → 임베딩 → 완료 단계별 진행률 표시
- **타임아웃 해결**: 긴 처리 시간에도 안정적인 업로드 지원

### ✅ 이전 수정 사항 (v5.1, 2026-01-28)

#### 오전/오후 수업시간 0 허용
- **0 입력 허용**: 오전 또는 오후 수업시간을 0으로 설정 가능 (예: 오전만 수업)
- **fallback 수정**: `|| 4` 패턴을 제거하여 0 입력이 강제로 4로 변환되지 않도록 수정
- **Division by zero 방어**: 일일 수업시간 합계가 0일 때 400 에러 반환
- **무한루프 방지**: `calculate_stage_detail`에서 오전/오후 둘 다 0이면 빈 결과 즉시 반환
- **0시간 슬롯 스킵**: 시간표 자동생성 시 `morning_hours` 또는 `afternoon_hours`가 0이면 해당 슬롯 생성 안 함

#### 시간표 자동생성 요일 배정 준수
- **요일별 교과목만 배치**: 교과목에 설정된 요일에만 수업 배치, 빈 요일은 빈 채로 유지
- **다른 요일 교과목 끌어오기 제거**: 해당 요일 교과목 시수가 소진되면 빈 요일로 건너뜀
- **오후 슬롯 요일 제한**: 오전 교과목 소진 시 같은 요일 배정 교과목 중에서만 오후 교과목 선택

### ✅ 주요 신규 기능 (v5.0, 2026-01-15)

#### ⭐ 파비콘 동적 업로드
- **파비콘 업로드 UI**: 시스템 설정에서 파비콘 직접 업로드
- **동적 적용**: 저장 즉시 브라우저 탭 아이콘 변경
- **FTP 지원**: FTP URL 파비콘도 프록시를 통해 표시

#### 🔌 시스템 연결 테스트
- **DB 연결 테스트**: 데이터베이스 연결 상태 실시간 확인
- **FTP 연결 테스트**: 파일 서버 연결 상태 확인
- **응답 시간 표시**: 연결 성공 시 응답 시간(ms) 표시

#### 👤 기본 아바타 시스템
- **Dicebear 아바타**: 프로필 사진 없는 경우 자동 아바타 생성
- **성별 기반 스타일**: 남/여 성별에 따라 다른 아바타 색상
- **학생/강사 목록**: 프로필 사진 없을 때 아이콘 대신 아바타 표시

#### 📋 DB 로그 스크롤바
- **최대 높이 제한**: DB 관리 로그 영역에 max-height 적용
- **스크롤 가능**: 로그가 많아도 영역 고정, 스크롤로 확인

#### 🔐 보안 강화
- **환경변수 분리**: 관리자 계정을 .env 파일로 분리
- **하드코딩 제거**: 민감한 정보 코드에서 제거

### ✅ 이전 버전 주요 기능 (v3.x)

#### 🔗 URL 공유 미리보기 (Open Graph)
- **소셜 미리보기**: 카카오톡, 페이스북 등에서 URL 공유 시 로고+제목+설명 표시
- **Open Graph 메타 태그**: og:title, og:description, og:image 추가
- **정적 OG 이미지**: 시스템 설정 저장 시 `/og-image.png`로 자동 복사

#### 📊 대시보드 권한 연동
- **메뉴 권한 기반 표시**: 허용되지 않은 메뉴의 대시보드 위젯 자동 숨김
- **통계 카드**: 학생, 강사, 과정, 시간표, 상담, 프로젝트 카드 권한 체크

#### 🔐 강사코드 권한 관리 UI 개선
- **계층형 메뉴 구조**: 실제 사이드바 메뉴와 동일한 모양으로 표시
- **상위 메뉴 연동**: 상위 메뉴 체크 해제 시 하위 메뉴 자동 해제

#### 📝 온라인시험/과제 시스템
- **시험 유형**: 시험, 퀴즈, 과제 3가지 유형 지원
- **과제 제출**: 파일 첨부 + 텍스트 답변 지원
- **자동/수동 채점**: 객관식은 자동, 서술형/과제는 수동 채점

#### 🗃️ DB 관리 시스템
- **DB 백업/복구**: 완전한 데이터베이스 백업 및 복구 기능
- **테이블별 선택 복구**: 특정 테이블만 선택하여 복구 가능
- **자동 백업**: 복구/초기화 전 자동 안전 백업 생성

#### 📊 성적 메뉴
- **문제은행**: RAG 기반 시험 문제 자동 생성
- **온라인시험**: 시험/퀴즈/과제 관리

## 시스템 운영 참고 사항

### 환경 설정
프로젝트 루트에 `.env` 파일 생성:
```bash
# 데이터베이스 설정
DB_HOST=localhost
DB_PORT=3306
DB_USER=your_user
DB_PASSWORD=your_password
DB_NAME=minilms

# FTP 설정
FTP_HOST=localhost
FTP_PORT=21
FTP_USER=your_ftp_user
FTP_PASSWORD=your_ftp_password

# 관리자 계정
ROOT_USER=root
ROOT_PASSWORD=your_admin_password
```

### 서비스 관리
```bash
systemctl start minilms    # 시작
systemctl stop minilms     # 중지
systemctl restart minilms  # 재시작
systemctl status minilms   # 상태 확인
journalctl -u minilms -f   # 로그 실시간 확인
```

## 📊 프로젝트 규모

- **총 코드 라인**: 36,000+ 라인
  - Backend (main.py): 11,000+ 라인
  - Frontend (app.js): 25,500+ 라인
- **API 엔드포인트**: 135+ 개
- **데이터베이스 테이블**: 18+ 개

## 지원
### 개발자 문의
- GitHub Issues: https://github.com/EmmettHwang/DSC_WOWU/issues

---

**마지막 업데이트**: 2026-02-06
**버전**: v5.6.6.202602062032
**버전 형식**: v{메이저}.{마이너}.{년월일시분}
**상태**: ✅ 프로덕션 배포 완료 + 🔍 RAG 시스템 + 📝 문제은행 + 🎓 온라인시험/과제 + 🗃️ DB 관리 + 👤 아바타 시스템

---

## 📝 작업 브랜치 변경 이력

### 2026-01-30
- **작업 브랜치**: `rise`
- **주요 작업**: BGM 버그 수정, RAG 비동기 처리, v5.2 릴리스
- **브랜치 상태**: `rise`, `main`, `master` 모두 동기화됨

### 2026-01-20
- **작업 브랜치 변경**: `main` → `sung`
- **변경 사유**: 개별 작업 브랜치에서 개발 진행
- **브랜치 상태**: `sung` 브랜치는 `main`의 모든 기능을 포함하고 있음
- **신규 기능**: 로그인 페이지에 Facebook/Instagram 소셜 미디어 링크 추가
