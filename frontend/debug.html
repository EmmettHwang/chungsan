<!DOCTYPE html>
<html>
<head>
    <title>ë””ë²„ê·¸ í˜ì´ì§€</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #00ff00; }
        pre { background: #000; padding: 10px; border: 1px solid #00ff00; margin: 10px 0; }
        button { background: #00ff00; color: #000; padding: 10px 20px; border: none; cursor: pointer; margin: 5px; }
        h2 { color: #ffff00; }
        .error { color: #ff0000; }
        .success { color: #00ff00; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
</head>
<body>
    <h1>ğŸ”§ ë””ë²„ê·¸ í˜ì´ì§€</h1>
    
    <h2>1. localStorage ìƒíƒœ</h2>
    <button onclick="checkLocalStorage()">í™•ì¸</button>
    <button onclick="clearAllCache()">ì „ì²´ ìºì‹œ ì‚­ì œ</button>
    <pre id="localStorage-result"></pre>
    
    <h2>2. API ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
    <button onclick="testAPI()">API í…ŒìŠ¤íŠ¸</button>
    <pre id="api-result"></pre>
    
    <h2>3. ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h2>
    <input type="text" id="name" placeholder="ì´ë¦„" value="í™©ë™ì˜">
    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" value="kdt2025">
    <button onclick="testLogin()">ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</button>
    <pre id="login-result"></pre>
    
    <h2>4. app.js ë¡œë“œ í™•ì¸</h2>
    <button onclick="checkAppJS()">í™•ì¸</button>
    <pre id="appjs-result"></pre>
    
    <script>
        const API_BASE_URL = 'https://8000-i3oloko346uog7d7oo8v5-3844e1b6.sandbox.novita.ai';
        
        function checkLocalStorage() {
            const result = document.getElementById('localStorage-result');
            const data = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                data[key] = localStorage.getItem(key);
            }
            result.textContent = JSON.stringify(data, null, 2);
        }
        
        function clearAllCache() {
            localStorage.clear();
            sessionStorage.clear();
            alert('âœ… ëª¨ë“  ìºì‹œ ì‚­ì œ ì™„ë£Œ');
            checkLocalStorage();
        }
        
        async function testAPI() {
            const result = document.getElementById('api-result');
            result.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                const students = await axios.get(`${API_BASE_URL}/api/students`);
                const instructors = await axios.get(`${API_BASE_URL}/api/instructors`);
                
                const hasCareerPath = students.data[0].career_path !== undefined;
                
                result.innerHTML = `<span class="success">âœ… API ì—°ê²° ì„±ê³µ!</span>\n\n` +
                    `í•™ìƒ: ${students.data.length}ëª…\n` +
                    `ê°•ì‚¬: ${instructors.data.length}ëª…\n` +
                    `career_path í•„ë“œ: ${hasCareerPath ? 'ìˆìŒ âœ…' : 'ì—†ìŒ âŒ'}\n` +
                    `ì²« í•™ìƒ career_path: ${students.data[0].career_path}`;
            } catch (error) {
                result.innerHTML = `<span class="error">âŒ ì—ëŸ¬: ${error.message}</span>`;
            }
        }
        
        async function testLogin() {
            const result = document.getElementById('login-result');
            const name = document.getElementById('name').value;
            const password = document.getElementById('password').value;
            
            result.textContent = 'ë¡œê·¸ì¸ ì¤‘...';
            
            try {
                const response = await axios.post(`${API_BASE_URL}/api/auth/login`, {
                    name: name,
                    password: password
                });
                
                if (response.data.success) {
                    localStorage.setItem('instructor', JSON.stringify(response.data.instructor));
                    localStorage.setItem('logged_in', 'true');
                    
                    result.innerHTML = `<span class="success">âœ… ë¡œê·¸ì¸ ì„±ê³µ!</span>\n\n` +
                        `ì´ë¦„: ${response.data.instructor.name}\n` +
                        `ìœ í˜•: ${response.data.instructor.instructor_type_name}`;
                } else {
                    result.innerHTML = `<span class="error">âŒ ${response.data.message}</span>`;
                }
            } catch (error) {
                result.innerHTML = `<span class="error">âŒ ì—ëŸ¬: ${error.message}</span>`;
            }
        }
        
        function checkAppJS() {
            const result = document.getElementById('appjs-result');
            result.textContent = 'í™•ì¸ ì¤‘...';
            
            if (typeof window.getCachedData === 'function') {
                result.innerHTML = `<span class="success">âœ… app.js ë¡œë“œë¨!</span>\n\n` +
                    `getCachedData: ì¡´ì¬\n` +
                    `API_BASE_URL: ${typeof API_BASE_URL !== 'undefined' ? API_BASE_URL : 'ì—†ìŒ'}`;
            } else {
                result.innerHTML = `<span class="error">âŒ app.jsê°€ ë¡œë“œë˜ì§€ ì•ŠìŒ</span>`;
            }
        }
    </script>
</body>
</html>
